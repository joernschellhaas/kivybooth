#:kivy 1.8.0
#:import KivyLexer kivy.extras.highlight.KivyLexer
#:import Factory kivy.factory.Factory
#:import icon kivysome.icon

<KBMenuButton@ActionButton>:
    font_size: 24
    height: 48
    markup: True

<KBScreen>:
    ScrollView:
        do_scroll_x: False
        do_scroll_y: False if root.fullscreen else (content.height > root.height - dp(16))
        AnchorLayout:
            size_hint_y: None
            height: root.height if root.fullscreen else max(root.height, content.height)
            GridLayout:
                id: content
                cols: 1
                spacing: '8dp'
                padding: '8dp'
                size_hint: (1, 1) if root.fullscreen else (.8, None)
                height: self.height if root.fullscreen else self.minimum_height


BoxLayout:
    orientation: 'vertical'

    canvas.before:
        Color:
            rgb: .6, .6, .6
        Rectangle:
            size: self.size
            source: 'res/background.png'

    ActionBar:

        ActionView:
            id: av
            height: 36
            ActionPrevious:
                with_previous: (False if sm.current_screen.name == 'button' else True) if sm.current_screen else False
                title: 'Photobooth' + ('' if not app.current_title else ' - {}'.format(app.current_title))
                on_release: app.go_hierarchy_previous()

            KBMenuButton:
                text: '%s Login' % icon('lock')
                on_release: app.go_to_screen("login")

    ScrollView:
        id: sv
        size_hint_y: None
        height: 0

        CodeInput:
            id: sourcecode
            lexer: KivyLexer()
            text: app.sourcecode
            readonly: True
            size_hint_y: None
            font_size: '12sp'
            height: self.minimum_height

    ScreenManager:
        id: sm
    #     on_current_screen:
    #         spnr.text = args[1].name
    #         idx = app.screen_names.index(args[1].name)
    #         if idx > -1: app.hierarchy.append(idx)
